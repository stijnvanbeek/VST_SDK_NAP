<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VST 3 Interfaces: Complex plug-in Structures / Multi-timbral Instruments</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxysmtg.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VST 3 Interfaces
   &#160;<span id="projectnumber">VST 3.7</span>
   </div>
   <div id="projectbrief">SDK for developing VST plug-in</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('vst3Multitimbral.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Complex plug-in Structures / Multi-timbral Instruments </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#vst3MultitimbralIntro">The Problem</a></li>
<li class="level1"><a href="#vst3IoMode">The Simple Mode</a></li>
<li class="level1"><a href="#vst3MultitimbralPrograms">Multi-timbral Program Lists</a></li>
<li class="level1"><a href="#vst3UnitsTracks">Units and Tracks</a></li>
<li class="level1"><a href="#vst3Routing">Routing</a></li>
</ul>
</div>
<div class="textblock"><p>How to handle complex plug-in structures and multi-timbrality.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="vst3Units.html">VST 3 Units</a></dd></dl>
<p><br />
Back to <b><a class="el" href="index.html#vst3Contents">Contents</a></b> <br />
<br />
</p>
<h1><a class="anchor" id="vst3MultitimbralIntro"></a>
The Problem</h1>
<p>A simple VST effect plug-in usually does not cause the host too many problems. It has only one audio input and output bus and a defined set of parameters that control aspects of its sound. But a VST plug-in can be a lot more complex than this. When the plug-in implements a multi-timbral musical instrument, the host is confronted with a range of problems regarding the integration of this plug-in in its GUI. To mention a few of them:</p><ul>
<li>The plug-in can define multiple event input and multiple audio outputs. How can the host know on which output a sound will emerge when a note-event is transmitted to the plug-in? <br />
-&gt; This may be of interest for the host in order to link a MIDI track to the corresponding audio channel. <br />
 <br />
</li>
<li>The plug-in can define a list of programs that the user can load from the plug-in GUI. In a multi-timbral instrument a program only affects a certain part of the plug-in (we call this part a 'unit'). How can the host know about these parts and about the plug-in defined programs that can be loaded? <br />
-&gt; This may be of interest for a host in order to provide shortcuts for this functionality in its own GUI.</li>
</ul>
<p>Since a VST plug-in unlike a hardware MIDI instrument is more than only a black box, a complex plug-in should help its host to provide a more convenient GUI integration than it is possible with hardware instruments. VST 3 uses the concept of units to describe the internal structure of the plug-in (see <a class="el" href="vst3Units.html">VST 3 Units</a>) and a multi-timbral instrument is supposed to support the respective interfaces. But the preferred solution in VST 3 is a reduction of this complexity with the 'simple mode'.</p>
<p><br />
Back to <b><a class="el" href="vst3Multitimbral.html">Top</a></b> <br />
<br />
</p>
<h1><a class="anchor" id="vst3IoMode"></a>
The Simple Mode</h1>
<p>The 'VST 3 simple mode' has the (selfish) background to support the so-called 'simple instrument tracks' of Cubase. These tracks combine a MIDI track and VST-audio-channel (without the need to make any further assignments such as the choice of a MIDI output port or a MIDI channel). This mode is defined as 'only one input and only one output'. In 'simple mode', only MIDI channel 0 is used. Therefore, an instrument has to be mono-timbral.</p>
<p>The host will now work with multiple instances of the plug-in rather than using the same instance in a way that it contains multiple internal sections of the same kind. The VST-MA component model supports shared resources between multiple instances of a plug-in because usually the same module instance (dll/bundle) is used for each plug-in instance.</p>
<p>Yet, a plug-in has the option to support both the simple and the advanced mode with the same implementation. The host tests the general ability to support the 'simple mode' by checking the processor's class flags (<a class="elRef" doxygen="/Builddata/re/255370135/b/VST_SDK/VST3_SDK/vst3_doc/base/base.tag:../base/" href="../base/structSteinberg_1_1PClassInfo2.html#ab5ab9135185421caad5ad8ae1d758409">Steinberg::PClassInfo2::classFlags</a>) for the <a class="el" href="namespaceSteinberg_1_1Vst.html#a626a070dcd2e025250f41b9c3f9817cdabc2edc9bb281cebe9cc6dc00a7cac0ea" title="Component supports simple IO mode (or works in simple mode anyway) see The Simple Mode.">Steinberg::Vst::kSimpleModeSupported</a> flag. If the plug-in is to be used in an instrument track (or whenever a host regards it more suitable) the <a class="el" href="classSteinberg_1_1Vst_1_1IComponent.html#a4618e7358890d549f990010bea4a4137" title="Called before &#39;initialize&#39; to set the component usage (optional).">Steinberg::Vst::IComponent::setIoMode</a> method is called (before any other call!) to configure the plug-in. A mono-timbral plug-in should set this flag as well and does not need to take into account the setIoMode call.</p>
<p><br />
Back to <b><a class="el" href="vst3Multitimbral.html">Top</a></b> <br />
<br />
</p>
<h1><a class="anchor" id="vst3MultitimbralPrograms"></a>
Multi-timbral Program Lists</h1>
<p>For a multi-timbral instrument plug-in preset handling can be a lot more complex. In this case: <br />
</p><ul>
<li>The plug-in can define any number of program lists. <br />
 <br />
</li>
<li>Each unit can reference one program list - this reference must not change. <br />
 <br />
</li>
<li>Each unit that uses a program list references one list item. <br />
 <br />
</li>
<li>For each unit referencing a program list, a program selection parameter has to be exported (<a class="el" href="structSteinberg_1_1Vst_1_1ParameterInfo.html#ae3a5143ca8d0e271dbc259645a4ae645a517665185bca1f4f3d77ce0a6468b8e3">Steinberg::Vst::ParameterInfo::kIsProgramChange</a>). <br />
 <br />
</li>
<li>The plug-in can provide GUI for the selection of programs, but it must synchronize the corresponding program selection parameter. <br />
 <br />
</li>
<li>A host may want to show the program list of the active unit in the same way as it shows the presets of a simple plug-in (usually in a separate control area at the top or the bottom of the window). The host must be able to display the correct list and the correct program name for the unit that has got the focus in the plug-in GUI.</li>
</ul>
<p><br />
To make this all work correctly, the plug-in must supply a valid implementation of <a class="el" href="classSteinberg_1_1Vst_1_1IUnitInfo.html" title="Edit controller extension to describe the plug-in structure: Vst::IUnitInfo.">Steinberg::Vst::IUnitInfo</a> and it must operate the callback interface <a class="el" href="classSteinberg_1_1Vst_1_1IUnitHandler.html" title="Host callback for unit support: Vst::IUnitHandler.">Steinberg::Vst::IUnitHandler</a> accordingly. <br />
 <br />
Similar to the simple case, the host may want to save and load preset files. The component state of the plug-in is not useful here. A preset of a complex plug-in can be: <br />
 <br />
</p><ul>
<li>The state of a plug-in unit <br />
 -&gt; To support this, the plug-in must implement the <a class="el" href="classSteinberg_1_1Vst_1_1IUnitData.html" title="Component extension to access unit data: Vst::IUnitData.">Steinberg::Vst::IUnitData</a> interface in its component part. <br />
 <br />
</li>
<li>The contents of an item in the program list <br />
 -&gt; To support this, the plug-in must implement the <a class="el" href="classSteinberg_1_1Vst_1_1IProgramListData.html" title="Component extension to access program list data: Vst::IProgramListData.">Steinberg::Vst::IProgramListData</a> interface in its component part.</li>
</ul>
<p><br />
A plug-in can support unit presets and program list presets.</p>
<div class="image">
<img src="program_lists.jpg" alt="program_lists.jpg"/>
</div>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="vst3Presets.html">Presets &amp; Program Lists</a>, <a class="el" href="classSteinberg_1_1Vst_1_1IProgramListData.html">Steinberg::Vst::IProgramListData</a>, <a class="el" href="classSteinberg_1_1Vst_1_1IUnitData.html">Steinberg::Vst::IUnitData</a></dd></dl>
<p><br />
Back to <b><a class="el" href="vst3Multitimbral.html">Top</a></b> <br />
<br />
</p>
<h1><a class="anchor" id="vst3UnitsTracks"></a>
Units and Tracks</h1>
<p>A unit can be associated with busses (or channels of busses). In particular, a unit can have a fixed and unique connection to an input MIDI-channel. For a host, it might be useful to know about this connection and which unit can be associated with a specific MIDI track as a result of this. Often, the GUI of a multi-timbral plug-in does not show the settings of all similar units at the same time. Instead, there is some kind of unit selection. The idea is to be able to synchronize the selection of units in a plug-in to the selection of tracks in the host (in both ways).</p>
<p>When a plug-in GUI is organized in the described way, it should support the described behavior by implementing</p><ul>
<li><a class="el" href="classSteinberg_1_1Vst_1_1IUnitInfo.html#a718fa905d04d7d559bc89c7ca761413b" title="Gets the according unit if there is an unambiguous relation between a channel or a bus and a unit.">Steinberg::Vst::IUnitInfo::getUnitByBus</a> : find out the track - unit relations</li>
<li><a class="el" href="classSteinberg_1_1Vst_1_1IUnitInfo.html#a6f1b43425ba894764f35b7d492e81c53" title="Gets the current selected unit.">Steinberg::Vst::IUnitInfo::getSelectedUnit</a> : let the host know which track to select</li>
<li><a class="el" href="classSteinberg_1_1Vst_1_1IUnitInfo.html#a2504c2bb3c57742102577f34cb58e257" title="Sets a new selected unit.">Steinberg::Vst::IUnitInfo::selectUnit</a> : cause the plug-in to select its unit</li>
</ul>
<p>and by calling</p><ul>
<li><a class="el" href="classSteinberg_1_1Vst_1_1IUnitHandler.html#ab05a9a8dcca888caeabdb8ed74766bc6" title="Notify host when a module is selected in plug-in GUI.">Steinberg::Vst::IUnitHandler::notifyUnitSelection</a> : trigger the host to synchronize its GUI</li>
</ul>
<p><br />
Back to <b><a class="el" href="vst3Multitimbral.html">Top</a></b> <br />
<br />
</p>
<h1><a class="anchor" id="vst3Routing"></a>
Routing</h1>
<p>For a host, it may be interesting to know which VSTi channel in the mixer is the output of a specific MIDI track if the plug-in defines multiple audio output busses (represented as VSTi mixer channels in the host). <br />
In general, the host needs to know about any input to output routing of the plug-in. So if an unambiguous relation exists between a plug-in input and an output, the following method should be implemented:</p><ul>
<li><a class="el" href="classSteinberg_1_1Vst_1_1IComponent.html#aa0ffeccad3c44364a199ce56365a4c12" title="Retrieves routing information (to be implemented when more than one regular input or output bus exist...">Steinberg::Vst::IComponent::getRoutingInfo</a> : find out the output of a given input</li>
</ul>
<div class="image">
<img src="routing.jpg" alt="routing.jpg"/>
</div>
<p><br />
Back to <b><a class="el" href="index.html#vst3Contents">Contents</a></b> <br />
</p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<html>
    <head>
	    <title>Empty</title>
	    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	    <meta name="Author" content="Steinberg">
    </head>
    <body>
    <br/>
    <hr width="100%" size="2" align="left" />
    <div align=right>
        Copyright &copy;2020 <a href="http://www.steinberg.net" target="_blank"><u>Steinberg Media Technologies GmbH</u></a>.
        All Rights Reserved. This documentation is under this <a href="http://www.steinberg.net/sdklicenses" target="_blank"><u>license</u></a>.
    </div>
</body>
</html>
